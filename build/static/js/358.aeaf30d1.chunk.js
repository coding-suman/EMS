"use strict";(self.webpackChunkems=self.webpackChunkems||[]).push([[358],{8358:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var n=a(5043),r=a(1221),l=a(5522),s=a(1918),c=a(157),i=a(3224),o=a(7451),d=a(8028),h=a(2167),u=a(7358),m=a(6645),x=a(8199),j=a(6012),T=a(5384),k=a(5532),g=a(927),p=a(4590),y=a(4929),S=a(3984),C=a(1300),b=a(3461),f=a(4776),v=a(7921),I=a(6642),w=a(5607),O=a(2378),A=a(3401),N=a(3003),E=(a(8425),a(579));const $=()=>{const[e,t]=(0,n.useState)([]),[a,$]=(0,n.useState)([]),[F,D]=(0,n.useState)(!1),[W,z]=(0,n.useState)(null),[H,L]=(0,n.useState)("current"),[P,R]=(0,n.useState)(null),{isOpen:_,onOpen:B,onClose:J}=(0,r.j)();(0,N.wA)();(0,n.useEffect)((()=>{(async()=>{D(!0);try{const e=await w.A.get("/employees",{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});t(e.data)}catch(e){console.error("Error fetching employees:",e),A.oR.error("Failed to fetch employees.")}finally{D(!1)}})()}),[]);const M=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"current";D(!0);try{const a=await w.A.get(`/attendance/admin?month=${t}&userId=${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});$(a.data)}catch(a){console.error("Error fetching attendance records:",a),A.oR.error("Failed to fetch attendance records.")}finally{D(!1)}};return(0,E.jsxs)(l.az,{maxW:"1200px",mx:"auto",children:[(0,E.jsx)(s.s,{alignItems:"center",justifyContent:"space-between",mb:6,children:(0,E.jsx)(c.E,{fontSize:"2xl",fontWeight:"bold",children:"Admin Dashboard"})}),F?(0,E.jsx)(i.y,{}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(s.s,{direction:{base:"column",md:"row"},alignItems:"center",justifyContent:"flex-start",mb:4,gap:4,children:[(0,E.jsx)(o.l,{placeholder:"Select Employee",onChange:e=>{return t=e.target.value,z(t),void M(t,H);var t},value:W,width:{base:"100%",md:"auto"},children:e.map((e=>(0,E.jsxs)("option",{value:e._id,children:[e.firstName," ",e.lastName," - ",e.email]},e._id)))}),(0,E.jsxs)(o.l,{value:H,onChange:e=>{const t=e.target.value;L(t),W&&M(W,t)},width:{base:"100%",md:"auto"},children:[(0,E.jsx)("option",{value:"current",children:"Current Month"}),(0,E.jsx)("option",{value:"2024-08",children:"August 2024"}),(0,E.jsx)("option",{value:"2024-07",children:"July 2024"})]}),(0,E.jsx)(d.$,{colorScheme:"teal",mt:{base:2,md:0},children:(0,E.jsx)(O.CSVLink,{data:a,headers:[{label:"First Name",key:"firstName"},{label:"Last Name",key:"lastName"},{label:"Email",key:"email"},{label:"Check-In Time",key:"checkInTime"},{label:"Check-Out Time",key:"checkOutTime"},{label:"Total Working Hours",key:"totalWorkHours"},{label:"Total Pause Time",key:"totalPauseTime"},{label:"Status",key:"status"}],filename:"attendance_records.csv",className:"btn btn-primary",children:"Export to CSV"})})]}),(0,E.jsxs)(h.X,{variant:"simple",children:[(0,E.jsx)(u.d,{children:(0,E.jsxs)(m.Tr,{children:[(0,E.jsx)(x.Th,{children:"First Name"}),(0,E.jsx)(x.Th,{children:"Last Name"}),(0,E.jsx)(x.Th,{children:"Email"}),(0,E.jsx)(x.Th,{children:"Check-In Time"}),(0,E.jsx)(x.Th,{children:"Check-Out Time"}),(0,E.jsx)(x.Th,{children:"Total Working Hours"}),(0,E.jsx)(x.Th,{children:"Total Pause Time"}),(0,E.jsx)(x.Th,{children:"Status"}),(0,E.jsx)(x.Th,{children:"Actions"})]})}),(0,E.jsx)(j.N,{children:a.map((e=>(0,E.jsxs)(m.Tr,{children:[(0,E.jsx)(T.Td,{children:e.firstName}),(0,E.jsx)(T.Td,{children:e.lastName}),(0,E.jsx)(T.Td,{children:e.email}),(0,E.jsx)(T.Td,{children:new Date(e.checkInTime).toLocaleString()}),(0,E.jsx)(T.Td,{children:new Date(e.checkOutTime).toLocaleString()}),(0,E.jsx)(T.Td,{children:e.totalWorkHours?e.totalWorkHours.toFixed(2):"0.00"}),(0,E.jsx)(T.Td,{children:e.totalPauseTime?e.totalPauseTime.toFixed(2):"0.00"}),(0,E.jsx)(T.Td,{children:e.status}),(0,E.jsx)(T.Td,{children:(0,E.jsx)(d.$,{onClick:()=>(e=>{R(e),B()})(e),children:"Edit"})})]},e._id)))})]}),(0,E.jsxs)(k.aF,{isOpen:_,onClose:J,children:[(0,E.jsx)(g.m,{}),(0,E.jsxs)(p.$,{children:[(0,E.jsx)(y.r,{children:"Edit Attendance Record"}),(0,E.jsx)(S.s,{}),(0,E.jsxs)(C.c,{children:[(0,E.jsxs)(b.MJ,{children:[(0,E.jsx)(f.l,{children:"Check-In Time"}),(0,E.jsx)(v.p,{type:"datetime-local",value:null!==P&&void 0!==P&&P.checkInTime?new Date(P.checkInTime).toISOString().slice(0,-1):"",onChange:e=>R({...P,checkInTime:new Date(e.target.value).toISOString()})})]}),(0,E.jsxs)(b.MJ,{mt:4,children:[(0,E.jsx)(f.l,{children:"Check-Out Time"}),(0,E.jsx)(v.p,{type:"datetime-local",value:null!==P&&void 0!==P&&P.checkOutTime?new Date(P.checkOutTime).toISOString().slice(0,-1):"",onChange:e=>R({...P,checkOutTime:new Date(e.target.value).toISOString()})})]})]}),(0,E.jsxs)(I.j,{children:[(0,E.jsx)(d.$,{colorScheme:"blue",mr:3,onClick:async()=>{try{await w.A.put(`/attendance/${P._id}`,P,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),A.oR.success("Attendance record updated successfully!"),J(),M(W,H)}catch(e){console.error("Error updating attendance record:",e),A.oR.error("Failed to update attendance record!")}},children:"Save"}),(0,E.jsx)(d.$,{onClick:J,children:"Cancel"})]})]})]})]})]})}}}]);
//# sourceMappingURL=358.aeaf30d1.chunk.js.map